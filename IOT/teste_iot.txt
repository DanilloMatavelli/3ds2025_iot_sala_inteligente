#include<WiFi.h>
#include <HTTPClient.h>
const char* rede_wifi = "Wokwi-GUEST"; 
const char* senha_wifi = ""; 

const byte FOTORESISTOR = A0;
int valorFoto;

void conectarWiFi() {
  rede.addAP(rede_wifi, senha_wifi); 
  Serial.print("Conectando ao WiFi");

  while (rede.run() != WL_CONNECTED) { 
    delay(1000);
    Serial.print(".");
  }
  
  Serial.println("\nWiFi Conectado!");
  Serial.print("IP: ");
  Serial.println(WiFi.localIP());
  Serial.print("MAC: ");
  Serial.println(WiFi.macAddress());
}

void setup(){
conectarWiFi();
Serial.begin(9600);
pinMode(FOTORESISTOR, INPUT);
}

void loop(){
HTTPClient http; 
http.begin("https://sala-inteligente1-nsrl.onrender.com/post/lampada/ligada"); 
int httpResponCode = http.GET();
Serial.println(httpResponCode); 
if(httpResponCode == 200){
respostaJson = http.getString(); 
Serial.print(respostaJson);
}else{
Serial.print("error ");
Serial.println(httpResponCode);
}


HTTPClient http;
  valorFoto = analogRead(FOTORESISTOR);
  if(valorFoto<=500){
    http.begin("https://sala-inteligente1-nsrl.onrender.com/post/lampada/ligada"); 
    int httpResponCode = http.GET();
    Serial.println(httpResponCode); 
    if(!httpResponCode == 200){
      Serial.print("error ");
      Serial.println(httpResponCode);
    }
  }else{
  	http.begin("https://sala-inteligente1-nsrl.onrender.com/post/lampada/desligada"); 
    int httpResponCode = http.GET();
    Serial.println(httpResponCode); 
    if(!httpResponCode == 200){
      Serial.print("error ");
      Serial.println(httpResponCode);
    }
  }

}